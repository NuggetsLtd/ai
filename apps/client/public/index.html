<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="favicon.svg" />

  <title>Chat</title>
  <style>
    html,
    body {
      height: 100%;
    }

    body {
      font-family: Arial, Helvetica, sans-serif;
      margin: 0;
      height: 100%;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #f2f2f2;
    }

    .chat {
      width: auto;
      max-width: 600px;
      width: 100%;
    }

    .chat__container {
      background-color: #fff;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0px 4px 24px #d8d8d8;
    }

    .chat__title {
      margin-top: 0;
    }

    .chat__messages {
      list-style-type: none;
      margin: 0;
      padding: 0;
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 10px;
      background-color: #8664a014;
      font-size: 16px;
    }

    .chat__message {
      margin-top: 5px;
    }

    .chat__message:first-child {
      margin-top: 0;
    }

    .chat__message--own::before {
      content: "You üßë‚Äçü¶∞: ";
      font-weight: bold;
    }

    .chat__message--assistant::before {
      content: "Bot ü§ñ: ";
      font-weight: bold;
    }

    .chat__form {
      position: relative;
      margin-top: 1em;
      font-size: 16px;
    }

    .chat__messageInput {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      padding-right: 110px;
      box-sizing: border-box;
      font-size: 16px;
    }

    .chat__sendButton {
      background-color: blue;
      color: aliceblue;
      border: none;
      border-radius: 5px;
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
      padding: 10px;
      cursor: pointer;
      position: absolute;
      right: 0;
      top: 0;
      height: 100%;
      width: 100px;
      font-size: 16px;
    }

    .chat__nuggetsInvite {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 10px;
      margin-bottom: 10px;
      flex-direction: column;
      border-radius: 15px;
      background-color: #fff;
    }

    .chat__qrCode {
      position: relative;
      padding: 10px;
      padding-bottom: 0;
    }

    .chat__qrCode svg:first-child {
      width: 180px;
      height: auto;
    }

    .chat__qrCode svg:first-child path:nth-child(2) {
      stroke: #8664a0;
    }

    .chat__nuggetsIcon {
      position: absolute;
      top: 50%;
      left: 50%;
      height: 36px;
      margin-left: -18px;
      margin-top: -18px;
    }

    .nuggets__logo {
      width: 150px;
      margin: 20px auto 0;
    }

    .chat__nuggetsInviteDeeplink {
      text-decoration: none;
      background-color: #8664a0;
      color: #fff;
      border: none;
      border-radius: 5px;
      padding: 10px;
      cursor: pointer;
      font-size: 14px;
      display: block;
      text-align: center;
      width: 140px;
    }

    .chat__qrCodeReference {
      font-size: 12px;
      color: #333;
      text-align: center;
      margin: 15px 0;
    }

    .notification {
      padding: 15px;
    }
  </style>
</head>

<body>
  <section class="chat">
    <div class="chat__container">
      <h1 class="chat__title">Nuggets MCP Chat PoC</h1>
      <ul id="messages" class="chat__messages"></ul>
      <form id="form" class="chat__form" action="">
        <input id="messageInput" class="chat__messageInput" autocomplete="off" autofocus />
        <button id="sendButton" class="chat__sendButton">Send</button>
      </form>
    </div>
    <footer class="nuggets__logo">
      <?xml version="1.0" encoding="UTF-8"?>
      <svg viewBox="0 0 474 162" version="1.1" xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink">
        <title>nuggets-new-icon-and-logotype-TM-7100CE-powered-black</title>
        <defs>
          <radialGradient cx="50.000064%" cy="49.999936%" fx="50.000064%" fy="49.999936%" r="50.120282%"
            gradientTransform="translate(0.5, 0.5), scale(0.9976, 1), translate(-0.5, -0.5)" id="radialGradient-1">
            <stop stop-color="#3F0170" offset="0%"></stop>
            <stop stop-color="#3F0170" stop-opacity="0" offset="100%"></stop>
          </radialGradient>
        </defs>
        <g id="nuggets-new-icon-and-logotype-TM-7100CE-powered-black" stroke="none" stroke-width="1" fill="none"
          fill-rule="evenodd">
          <g id="Nuggets-Icon-and-Logotype-with-TM-7100CE" transform="translate(0, 0)">
            <g id="Icon-and-Logotype" transform="translate(0.0361, 2.2787)">
              <g id="Nuggets-Logotype-and-TM" transform="translate(91.4233, 7.1779)" fill="#7100CE" fill-rule="nonzero">
                <g id="TM" transform="translate(318.8891, 77.6673)">
                  <polygon id="Path"
                    points="5.57965714 0.0090069156 5.57965714 1.43209958 3.53017143 1.43209958 3.53017143 7.5658091 2.03142857 7.5658091 2.03142857 1.43209958 0 1.43209958 0 0.0090069156">
                  </polygon>
                  <polygon id="Path"
                    points="14.7436571 0.0090069156 14.7436571 7.57481602 13.2629714 7.57481602 13.2629714 2.66604702 11.1322286 6.1787441 10.9606857 6.1787441 8.82994286 2.67505393 8.82994286 7.5658091 7.34022857 7.5658091 7.34022857 0 8.87508571 0 11.0509714 3.57574549 13.2178286 0 14.7526857 0">
                  </polygon>
                </g>
                <g id="Logotype" transform="translate(39.0305, 38.9375)">
                  <path
                    d="M16.4229714,7.34063621 C7.05131429,7.34063621 0,13.87065 0,23.2198284 L0,46.2595185 L6.5096,46.2595185 L6.5096,23.0036624 C6.5096,17.3022849 10.7981714,13.4743457 16.4229714,13.4743457 C22.0477714,13.4743457 26.2641143,17.3022849 26.2641143,23.0036624 L26.2641143,46.2595185 L32.7737143,46.2595185 L32.7737143,23.2198284 C32.7737143,13.87065 25.7494857,7.34063621 16.4229714,7.34063621"
                    id="Path"></path>
                  <path
                    d="M63.8139429,30.1461465 C63.8139429,35.8475241 59.5614857,39.6754632 53.9728,39.6754632 C48.3841143,39.6754632 44.5650286,35.8475241 44.5650286,30.1461465 L44.5650286,7.17851173 L38.0554286,7.17851173 L38.0554286,30.1461465 C38.0554286,39.3512142 44.7546286,46.0253387 53.9728,46.0253387 C63.1909714,46.0253387 70.3957714,39.3422073 70.3957714,30.1461465 L70.3957714,7.17851173 L63.8139429,7.17851173 L63.8139429,30.1461465 Z"
                    id="Path"></path>
                  <path
                    d="M256.853829,22.517289 C248.764229,21.34639 246.796,20.3736431 246.443886,17.6985891 C246.046629,14.7173001 250.371314,12.4385504 255.815543,12.4385504 C260.862514,12.4385504 264.780914,14.4831203 265.746971,18.5002046 L272.635771,18.5002046 C271.750971,11.1235408 265.349714,6.73717287 255.815543,6.73717287 C244.764571,6.73717287 239.500914,12.2944398 239.636343,17.9147551 C239.816914,24.9941908 245.7216,27.1918782 255.734286,28.5068879 C265.828229,29.7498422 266.731086,31.7313636 266.947771,34.3523761 C267.227657,37.7209625 263.020343,40.4860856 256.619086,40.4860856 C250.696343,40.4860856 245.965371,37.7840109 245.0896,33.397643 L238.2008,33.397643 C239.320343,41.3597564 246.6064,46.2505116 256.619086,46.2505116 C266.631771,46.2505116 273.7192,41.5038671 273.520571,33.9830925 C273.285829,25.4535435 265.990743,23.8322987 256.862857,22.517289"
                    id="Path"></path>
                  <path
                    d="M138.994857,7.18751865 C128.296,7.18751865 119.619543,15.8431645 119.619543,26.5163595 C119.619543,37.1895545 128.296,45.8452004 138.994857,45.8452004 C143.852229,45.8452004 148.276229,44.0618311 151.68,41.1165697 L151.698057,44.926495 C151.698057,51.9248684 146.010057,57.5992252 138.994857,57.5992252 C134.083314,57.5992252 129.821829,54.8160883 127.709143,50.7449625 L120.531429,50.789997 C123.023314,58.5989929 130.345486,64.2553359 138.994857,64.2553359 C149.693714,64.2553359 158.370171,55.59969 158.370171,44.926495 L158.370171,25.0482323 L158.306971,25.0482323 C157.548571,15.0685698 149.197143,7.19652556 138.994857,7.19652556 M138.994857,39.1980967 C131.979657,39.1980967 126.291657,33.5237398 126.291657,26.5253664 C126.291657,19.526993 131.979657,13.8526362 138.994857,13.8526362 C145.513486,13.8526362 150.876457,18.7433914 151.607771,25.0482323 L151.607771,25.0482323 L151.607771,27.9034245 C150.930629,34.2533 145.540571,39.1980967 138.994857,39.1980967"
                    id="Shape"></path>
                  <path
                    d="M95.1250286,7.18751865 C84.4261714,7.18751865 75.7497143,15.8431645 75.7497143,26.5163595 C75.7497143,37.1895545 84.4261714,45.8452004 95.1250286,45.8452004 C99.9824,45.8452004 104.4064,44.0618311 107.810171,41.1165697 L107.828229,44.926495 C107.828229,51.9248684 102.140229,57.5992252 95.1250286,57.5992252 C90.2134857,57.5992252 85.952,54.8160883 83.8393143,50.7449625 L76.6616,50.789997 C79.1534857,58.5989929 86.4756571,64.2553359 95.1250286,64.2553359 C105.823886,64.2553359 114.500343,55.59969 114.500343,44.926495 L114.500343,25.0482323 L114.437143,25.0482323 C113.678743,15.0685698 105.327314,7.19652556 95.1250286,7.19652556 M95.1250286,39.1980967 C88.1098286,39.1980967 82.4218286,33.5237398 82.4218286,26.5253664 C82.4218286,19.526993 88.1098286,13.8526362 95.1250286,13.8526362 C101.643657,13.8526362 107.006629,18.7433914 107.737943,25.0482323 L107.737943,25.0482323 L107.737943,27.9034245 C107.0608,34.2533 101.670743,39.1980967 95.1250286,39.1980967"
                    id="Shape"></path>
                  <path
                    d="M183.948114,7.30460855 C173.249257,7.30460855 164.5728,15.9602544 164.5728,26.6334494 C164.5728,37.3066444 173.249257,45.9622903 183.948114,45.9622903 C192.227314,45.9622903 199.287657,40.7833138 202.059429,33.4967191 L194.674057,33.4967191 C192.416914,36.9914024 188.471429,39.3061797 183.993257,39.3061797 C177.456571,39.3061797 172.075543,34.3793968 171.371314,28.0475352 L203.269257,28.0295213 C203.305371,27.5701686 203.323429,27.101809 203.323429,26.6334494 C203.323429,15.9602544 194.646971,7.30460855 183.948114,7.30460855 M171.931086,22.6613996 C173.601371,17.60852 178.368457,13.9517123 184.002286,13.9517123 C189.636114,13.9517123 194.376114,17.6265338 196.064457,22.6433858 L171.931086,22.6613996 L171.931086,22.6613996 Z"
                    id="Shape"></path>
                  <path
                    d="M229.867429,39.3241935 C216.035657,39.3241935 217.055886,26.0930345 217.055886,23.1928077 L217.055886,14.6812724 L229.822286,14.6812724 L229.822286,8.11523095 L217.055886,8.11523095 L217.055886,0 L210.320571,0 C210.320571,0 210.320571,20.0223734 210.320571,25.5706334 C210.320571,36.2618422 216.0176,45.9442765 229.027771,45.9442765 L234.742857,45.9442765 L234.742857,39.3241935 L229.867429,39.3241935 L229.867429,39.3241935 Z"
                    id="Path"></path>
                </g>
              </g>
              <g id="Icon-and-Shadow">
                <ellipse id="Shadow" fill="url(#radialGradient-1)" cx="79.6861714" cy="79.1707881" rx="30.6971429"
                  ry="30.623513"></ellipse>
                <g id="New-Icon-Vector-Group" transform="translate(49.1154, 48.5473)">
                  <polygon id="Fill-4" fill="#952CC8"
                    points="27.0878933 6.42050494 27.0974502 41.8015837 0.00470200929 24.0999849"></polygon>
                  <polygon id="Fill-5" fill="#7F01BD"
                    points="27.0981383 41.8015075 27.0885814 6.42042867 54.1713903 24.10029"></polygon>
                  <polygon id="Fill-6" fill="#B867D7"
                    points="0.00458732614 24.1000612 12.0302628 0 27.0885431 6.42058121"></polygon>
                  <polygon id="Fill-7" fill="#A556D7"
                    points="54.1714286 24.1001374 42.1518695 7.62720504e-05 27.0935892 6.42065748"></polygon>
                  <polygon id="Fill-8" fill="#5C2383"
                    points="54.1668412 24.1086799 42.1411658 48.2087411 27.0828854 41.7881598"></polygon>
                  <polygon id="Fill-10" fill="#C482DE" points="12.0303775 0 42.1519078 0 27.0936274 6.42058121">
                  </polygon>
                  <polygon id="Fill-11" fill="#450875"
                    points="42.1410511 48.2087411 12.0195208 48.2087411 27.0885049 41.7839649"></polygon>
                  <polygon id="Fill-9" fill="#7E00BA" points="0 24.1085655 12.019559 48.2086266 27.0778394 41.7880454">
                  </polygon>
                </g>
              </g>
            </g>
            <g id="Powered" transform="translate(343.6868, 101.3409)" fill="#000000" fill-rule="nonzero">
              <path
                d="M1.49132075,11.1815684 L1.49132075,6.60871407 L4.91350943,6.60871407 C6.04377358,6.61915438 6.89932075,6.33204595 7.48015094,5.74738878 C8.06098113,5.16273161 8.35139623,4.34838769 8.35139623,3.30435704 C8.35139623,2.26032638 8.06098113,1.44859254 7.48015094,0.869155524 C6.89932075,0.289718508 6.04377358,0 4.91350943,0 L0,0 L0,11.1815684 L1.49132075,11.1815684 Z M4.41116981,5.35587728 L1.49132075,5.35587728 L1.49132075,1.25283679 L4.41116981,1.25283679 C5.25886792,1.25283679 5.8789434,1.42771193 6.27139623,1.7774622 C6.66384906,2.12721247 6.86007547,2.63617741 6.86007547,3.30435704 C6.86007547,3.97253666 6.66384906,4.48411168 6.27139623,4.8390821 C5.8789434,5.19405253 5.25886792,5.36631759 4.41116981,5.35587728 Z M13.453283,11.3538334 C14.1021384,11.3538334 14.6698868,11.2468203 15.1565283,11.032794 C15.6431698,10.8187677 16.0539371,10.521219 16.3888302,10.1401478 C16.7237233,9.75907658 16.9748931,9.31275348 17.1423396,8.80117846 C17.3097862,8.28960343 17.3935094,7.73626718 17.3935094,7.14116971 C17.3935094,6.54607223 17.3097862,5.99012591 17.1423396,5.47333073 C16.9748931,4.95653555 16.7237233,4.50760237 16.3888302,4.12653118 C16.0539371,3.74545999 15.6431698,3.44530117 15.1565283,3.22605474 C14.6698868,3.0068083 14.1021384,2.89718508 13.453283,2.89718508 C12.8148931,2.89718508 12.249761,3.0068083 11.7578868,3.22605474 C11.2660126,3.44530117 10.8526289,3.74545999 10.5177358,4.12653118 C10.1828428,4.50760237 9.93167296,4.95653555 9.76422642,5.47333073 C9.59677987,5.99012591 9.5130566,6.54607223 9.5130566,7.14116971 C9.5130566,7.73626718 9.59677987,8.28960343 9.76422642,8.80117846 C9.93167296,9.31275348 10.1828428,9.75907658 10.5177358,10.1401478 C10.8526289,10.521219 11.2660126,10.8187677 11.7578868,11.032794 C12.249761,11.2468203 12.8148931,11.3538334 13.453283,11.3538334 Z M13.453283,10.1949594 C13.1079245,10.1949594 12.7808805,10.1270974 12.4721509,9.99137341 C12.1634214,9.85564942 11.8939371,9.65989367 11.6636981,9.40410616 C11.4334591,9.14831865 11.2529308,8.8298893 11.1221132,8.44881811 C10.9912956,8.06774692 10.9258868,7.63186412 10.9258868,7.14116971 C10.9258868,6.6504753 10.9912956,6.2145925 11.1221132,5.83352131 C11.2529308,5.45245012 11.4334591,5.13141069 11.6636981,4.87040302 C11.8939371,4.60939536 12.1634214,4.41102953 12.4721509,4.27530555 C12.7808805,4.13958156 13.1079245,4.07171957 13.453283,4.07171957 C13.7986415,4.07171957 14.1256855,4.13958156 14.4344151,4.27530555 C14.7431447,4.41102953 15.0126289,4.60939536 15.2428679,4.87040302 C15.4731069,5.13141069 15.6536352,5.45245012 15.7844528,5.83352131 C15.9152704,6.2145925 15.9806792,6.6504753 15.9806792,7.14116971 C15.9806792,7.63186412 15.9152704,8.06774692 15.7844528,8.44881811 C15.6536352,8.8298893 15.4731069,9.14831865 15.2428679,9.40410616 C15.0126289,9.65989367 14.7431447,9.85564942 14.4344151,9.99137341 C14.1256855,10.1270974 13.7986415,10.1949594 13.453283,10.1949594 Z M22.2756226,11.1815684 L23.9082264,4.74511935 L23.9396226,4.74511935 L25.5879245,11.1815684 L27.0007547,11.1815684 L29.5909434,3.0851106 L28.2095094,3.0851106 L26.3885283,9.70948513 L26.3571321,9.70948513 L24.6617358,3.0851106 L23.2018113,3.0851106 L21.5692075,9.70948513 L21.5378113,9.70948513 L19.7011321,3.0851106 L18.2255094,3.0851106 L20.8313962,11.1815684 L22.2756226,11.1815684 Z M34.3160755,11.3538334 C35.2370314,11.3538334 36.0010063,11.1241467 36.608,10.6647732 C37.2149937,10.2053997 37.6074465,9.52155961 37.7853585,8.61325294 L36.466717,8.61325294 C36.3515975,9.14570857 36.1135094,9.54244022 35.7524528,9.80344789 C35.3913962,10.0644556 34.9283019,10.1949594 34.3631698,10.1949594 C33.9236226,10.1949594 33.5416352,10.1218772 33.2172075,9.97571295 C32.8927799,9.82954865 32.6259119,9.63379291 32.4166038,9.3884457 C32.2072956,9.1430985 32.0555472,8.86121022 31.9613585,8.54278087 C31.8671698,8.22435152 31.8253082,7.88765163 31.8357736,7.5326812 L37.9109434,7.5326812 C37.9318742,7.04198679 37.8873962,6.52519162 37.7775094,5.98229568 C37.6676226,5.43939973 37.4687799,4.93826502 37.1809811,4.47889153 C36.8931824,4.01951804 36.511195,3.64105692 36.0350189,3.34350819 C35.5588428,3.04595945 34.9596981,2.89718508 34.2375849,2.89718508 C33.6829182,2.89718508 33.1727296,3.00158814 32.7070189,3.21039428 C32.2413082,3.41920041 31.8383899,3.71152899 31.4982642,4.08738003 C31.1581384,4.46323107 30.8938868,4.9069441 30.7055094,5.41851912 C30.5171321,5.93009414 30.4229434,6.4938707 30.4229434,7.10984879 C30.4438742,7.72582688 30.5354465,8.29482359 30.6976604,8.81683892 C30.8598742,9.33885424 31.103195,9.78778743 31.4276226,10.1636385 C31.7520503,10.5394895 32.1523522,10.8318181 32.6285283,11.0406242 C33.1047044,11.2494304 33.6672201,11.3538334 34.3160755,11.3538334 Z M36.4981132,6.35814671 L31.8357736,6.35814671 C31.8567044,6.04493752 31.9247296,5.74999885 32.0398491,5.47333073 C32.1549686,5.19666261 32.3119497,4.95392548 32.5107925,4.74511935 C32.7096352,4.53631321 32.9477233,4.37187838 33.2250566,4.25181486 C33.5023899,4.13175133 33.8137358,4.07171957 34.1590943,4.07171957 C34.4939874,4.07171957 34.8001006,4.13175133 35.077434,4.25181486 C35.3547673,4.37187838 35.5954717,4.53370314 35.7995472,4.73728912 C36.0036226,4.94087509 36.1658365,5.18361222 36.2861887,5.4655005 C36.4065409,5.74738878 36.4771824,6.04493752 36.4981132,6.35814671 Z M40.5796226,11.1815684 L40.5796226,7.57966258 C40.5796226,7.05764725 40.6319497,6.59566369 40.7366038,6.19371188 C40.8412579,5.79176008 41.0087044,5.44984004 41.2389434,5.16795176 C41.4691824,4.88606348 41.7726792,4.6720372 42.149434,4.52587291 C42.5261887,4.37970861 42.981434,4.30662647 43.5151698,4.30662647 L43.5151698,2.89718508 C42.7930566,2.87630447 42.1965283,3.02246876 41.7255849,3.33567796 C41.2546415,3.64888715 40.856956,4.13436141 40.5325283,4.79210072 L40.5011321,4.79210072 L40.5011321,3.0851106 L39.245283,3.0851106 L39.245283,11.1815684 L40.5796226,11.1815684 Z M47.973434,11.3538334 C48.8943899,11.3538334 49.6583648,11.1241467 50.2653585,10.6647732 C50.8723522,10.2053997 51.264805,9.52155961 51.442717,8.61325294 L50.1240755,8.61325294 C50.008956,9.14570857 49.7708679,9.54244022 49.4098113,9.80344789 C49.0487547,10.0644556 48.5856604,10.1949594 48.0205283,10.1949594 C47.5809811,10.1949594 47.1989937,10.1218772 46.874566,9.97571295 C46.5501384,9.82954865 46.2832704,9.63379291 46.0739623,9.3884457 C45.8646541,9.1430985 45.7129057,8.86121022 45.618717,8.54278087 C45.5245283,8.22435152 45.4826667,7.88765163 45.4931321,7.5326812 L51.5683019,7.5326812 C51.5892327,7.04198679 51.5447547,6.52519162 51.4348679,5.98229568 C51.3249811,5.43939973 51.1261384,4.93826502 50.8383396,4.47889153 C50.5505409,4.01951804 50.1685535,3.64105692 49.6923774,3.34350819 C49.2162013,3.04595945 48.6170566,2.89718508 47.8949434,2.89718508 C47.3402767,2.89718508 46.8300881,3.00158814 46.3643774,3.21039428 C45.8986667,3.41920041 45.4957484,3.71152899 45.1556226,4.08738003 C44.8154969,4.46323107 44.5512453,4.9069441 44.3628679,5.41851912 C44.1744906,5.93009414 44.0803019,6.4938707 44.0803019,7.10984879 C44.1012327,7.72582688 44.192805,8.29482359 44.3550189,8.81683892 C44.5172327,9.33885424 44.7605535,9.78778743 45.0849811,10.1636385 C45.4094088,10.5394895 45.8097107,10.8318181 46.2858868,11.0406242 C46.7620629,11.2494304 47.3245786,11.3538334 47.973434,11.3538334 Z M50.1554717,6.35814671 L45.4931321,6.35814671 C45.5140629,6.04493752 45.5820881,5.74999885 45.6972075,5.47333073 C45.812327,5.19666261 45.9693082,4.95392548 46.1681509,4.74511935 C46.3669937,4.53631321 46.6050818,4.37187838 46.8824151,4.25181486 C47.1597484,4.13175133 47.4710943,4.07171957 47.8164528,4.07171957 C48.1513459,4.07171957 48.4574591,4.13175133 48.7347925,4.25181486 C49.0121258,4.37187838 49.2528302,4.53370314 49.4569057,4.73728912 C49.6609811,4.94087509 49.823195,5.18361222 49.9435472,5.4655005 C50.0638994,5.74738878 50.1345409,6.04493752 50.1554717,6.35814671 Z M56.2463396,11.3538334 C56.8114717,11.3538334 57.3295094,11.2546505 57.8004528,11.0562847 C58.2713962,10.8579189 58.6167547,10.5342693 58.8365283,10.0853362 L58.8679245,10.0853362 L58.8679245,11.1815684 L60.2022642,11.1815684 L60.2022642,0 L58.8679245,0 L58.8679245,4.16568233 L58.8365283,4.16568233 C58.6900126,3.92555528 58.5094843,3.72457938 58.2949434,3.56275462 C58.0804025,3.40092987 57.8527799,3.27042604 57.6120755,3.17124313 C57.3713711,3.07206021 57.1306667,3.00158814 56.8899623,2.95982692 C56.6492579,2.91806569 56.4242516,2.89718508 56.2149434,2.89718508 C55.5974843,2.89718508 55.0558994,3.00941837 54.5901887,3.23388497 C54.124478,3.45835156 53.7372579,3.76112045 53.4285283,4.14219164 C53.1197987,4.52326283 52.8895597,4.96958594 52.7378113,5.48116096 C52.5860629,5.99273598 52.5101887,6.53563193 52.5101887,7.10984879 C52.5101887,7.68406565 52.5886792,8.22696159 52.7456604,8.73853662 C52.9026415,9.25011164 53.1354969,9.69904482 53.4442264,10.0853362 C53.752956,10.4716275 54.1401761,10.7796166 54.6058868,11.0093033 C55.0715975,11.23899 55.6184151,11.3538334 56.2463396,11.3538334 Z M56.434717,10.1949594 C56.0056352,10.1949594 55.6314969,10.1114369 55.3123019,9.94439203 C54.9931069,9.77734712 54.7314717,9.55288053 54.5273962,9.27099225 C54.3233208,8.98910397 54.1715723,8.66806455 54.0721509,8.30787397 C53.9727296,7.94768339 53.9230189,7.57966258 53.9230189,7.20381155 C53.9230189,6.8070799 53.9648805,6.42078855 54.0486038,6.04493752 C54.132327,5.66908648 54.2683774,5.33499667 54.4567547,5.04266808 C54.6451321,4.7503395 54.8963019,4.5154326 55.2102642,4.33794739 C55.5242264,4.16046218 55.9062138,4.07171957 56.3562264,4.07171957 C56.8167044,4.07171957 57.2091572,4.1578521 57.5335849,4.33011716 C57.8580126,4.50238222 58.1222642,4.72945889 58.3263396,5.01134716 C58.5304151,5.29323544 58.6795472,5.61949502 58.7737358,5.99012591 C58.8679245,6.36075679 58.9150189,6.74443806 58.9150189,7.14116971 C58.9150189,7.51702074 58.8705409,7.88765163 58.7815849,8.25306236 C58.6926289,8.61847309 58.5487296,8.94473267 58.3498868,9.2318411 C58.151044,9.51894953 57.8946415,9.75124635 57.5806792,9.92873157 C57.266717,10.1062168 56.8847296,10.1949594 56.434717,10.1949594 Z">
              </path>
            </g>
          </g>
        </g>
      </svg>
    </footer>
  </section>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.2.0/socket.io.js"></script>
  <script>
    const socket = io();

    const messages = document.getElementById('messages');
    const messageInput = document.getElementById('messageInput');
    const sendButton = document.getElementById('sendButton');
    const form = document.getElementById('form');

    function sendMessage() {
      const message = messageInput.value;

      if (message.trim() !== '') {
        socket.emit('chat message', message);
        messageInput.value = '';
        addMessageToList({ text: message }, true);
      }
    }

    function addMessageToList(message, isOwnMessage = false) {
      const item = document.createElement('li');
      item.classList.add('chat__message');

      (isOwnMessage)
        ? item.classList.add('chat__message--own')
        : item.classList.add('chat__message--assistant');

      if (message.text && message.url) {
        item.innerHTML = `<a href="${message.url}" target="_blank" class="chat__messageLink">Nuggets Verification Invite</a>`;
      }

      if (message.text && !message.url) {
        item.textContent = message.text;
      }

      if (message.type === 'image' && message.mimeType === 'image/svg+xml') {
        const svg = atob(message.data);
        item.innerHTML += `<div id="${message.ref}" class="chat__nuggetsInvite">
          <div class="chat__qrCode">
            ${svg}
            <svg class="chat__nuggetsIcon" viewBox="0 0 38 36" xmlns="http://www.w3.org/2000/svg">
              <defs>
                <filter x="-16.7%" y="-18.9%" width="133.3%" height="137.9%" filterUnits="objectBoundingBox" id="a">
                  <feOffset dx="1" dy="1" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset>
                  <feGaussianBlur stdDeviation=".5" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur>
                  <feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0" in="shadowBlurOuter1" result="shadowMatrixOuter1"></feColorMatrix>
                  <feMerge>
                    <feMergeNode in="shadowMatrixOuter1"></feMergeNode>
                    <feMergeNode in="SourceGraphic"></feMergeNode>
                  </feMerge>
                </filter>
              </defs>
              <g fill="none" fill-rule="evenodd">
                <path d="M25.531 1.204c1.3 0 2.544.368 3.61 1.027a6.906 6.906 0 012.539 2.777h0l5.182 10.322a6.96 6.96 0 01-.01 6.262h0L31.668 31.83a6.906 6.906 0 01-2.537 2.762 6.854 6.854 0 01-3.6 1.022h0-12.913a6.854 6.854 0 01-3.603-1.023 6.906 6.906 0 01-2.538-2.767h0l-5.17-10.237a6.96 6.96 0 01-.01-6.25h0l5.17-10.322a6.906 6.906 0 012.538-2.781 6.854 6.854 0 013.613-1.03h0z" stroke="#C8C8C8" stroke-width=".625" fill="#FFF"></path>
                <g filter="url(#a)" transform="translate(7.429 8.1)">
                  <path fill="#8168A0" d="M11.64 17.892l11.639-7.571-11.64-7.571z"></path>
                  <path fill="#CAC8E9" d="M5.168 0L0 10.32l11.64-7.57z"></path>
                  <path fill="#CAA3C7" d="M18.11 0l-6.47 2.75 11.639 7.57z"></path>
                  <path fill="#E4D8EB" d="M5.168 0l6.471 2.75L18.111 0z"></path>
                  <path fill="#793773" d="M5.168 20.642h12.943l-6.472-2.75z"></path>
                  <path fill="#7D4476" d="M11.64 17.892l6.47 2.75 5.17-10.322z"></path>
                  <path fill="#88739F" d="M5.168 20.642l6.471-2.75L0 10.321z"></path>
                  <path fill="#9B90C1" d="M0 10.32l11.64 7.572V2.75z"></path>
                </g>
              </g>
            </svg>
          </div>
          <div class="chat__qrCodeDeeplink">
            <a href="${message.deeplink}" target="_blank" class="chat__nuggetsInviteDeeplink">
              Open in Nuggets App
            </a>
          </div>
          <div class="chat__qrCodeReference">Ref: ${message.ref}</div>
        </div>`;
      }
      messages.appendChild(item);

      messages.scrollTop = messages.scrollHeight;
    }

    form.addEventListener('submit', (event) => {
      event.preventDefault();
      sendMessage();
    });

    sendButton.addEventListener('click', () => {
      sendMessage();
    });

    document.addEventListener('keypress', () => {
      if (event.key === 'Enter') {
        sendMessage();
      }
    });

    socket.on('chat message', (msg) => {
      const item = document.createElement('li');

      if (!msg?.content?.length) {
        return
      }

      msg.content.forEach(element => addMessageToList(element));
    });

    socket.on('chat notification', (msg) => {
      const nuggetsInviteBlock = document.getElementById(msg.ref);

      if (nuggetsInviteBlock && msg.status === 'IN PROGRESS') {
        nuggetsInviteBlock.innerHTML = `<div class="notification notification--in-progress">‚ÜîÔ∏è NUGGETS APP CONNECTED</div>`;
      }

      if (nuggetsInviteBlock && msg.status === 'COMPLETED') {
        nuggetsInviteBlock.innerHTML = `<div class="notification notification--complete">${msg.outcome.verified ? '‚úÖ VERIFICATION COMPLETE' : '‚ùå VERIFICATION FAILED'}</div>`;
      }
    })
  </script>
</body>

</html>
